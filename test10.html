<!DOCTYPE html>
<html>
<body>

<div id="demo">
<h2>The XMLHttpRequest Object</h2>
<button type="button" onclick="getAllUsers()">Change Content</button>
<div id="info"></div>
<div>After function</div>
</div>

<script>
    // const myURL = myRequest.url; // http://localhost/flowers.jpg
    // const myMethod = myRequest.method; // GET
    // const myCred = myRequest.credentials; // omit

    function getDetails(url, method) {
        console.log(url);
        console.log(method);
    }

    // let headers = new Headers();
    // headers.append('Access-Control-Allow-Origin', 'http://localhost:5000/');

    function getAllUsers() {
        const myRequest = new Request('http://localhost:5000/test/returnAllUsers');
        getDetails(myRequest.url, myRequest.method);
        fetch(myRequest, {mode: 'cors'})
            .then(response => response.json())
            .then(json => {
                // myImage.src = URL.createObjectURL(blob);
                console.log(json);
                // renderHTML(toString(json));
            })
            .catch(error =>
            console.log("Couldn't get users : " + error.message
            ));
    }

    function findChefs() {
        const chefsRequest = new Request('http://localhost:5000/api/findChefs', {method: 'POST',
        body: '{"cuisine_type":"Chinese", "location":"Anywhere"}'});
        getDetails(chefsRequest.url, chefsRequest.method);

        fetch(chefsRequest)
            .then(response => {
                if (response.status === 200) {
                    // return response.json();
                    console.log(response.json());
                    // renderHTML(toString(response.json()));
                }
                else {
                    throw new Error('Something went wrong on api server!');
                }
            })
            .then(response => {
                console.debug(response);
                // ...
            })
            .catch(error => {
                console.error(error);
            });

    }

    function renderHTML(data_to_write){
        document.getElementById("info").innerHTML = data_to_write;
    }
</script>

</body>
</html>
